<!DOCTYPE html>
<html>
  <head>
    <title>Standalone Devices (Demo)</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@7.2.96/css/materialdesignicons.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body ng-app="myApp" ng-controller="myCtrl">
    <div class="infobox-background" ng-show="!online || showoutput" id="offline">Connecting</div>

    {%for sig_name, sig in stinger.signals.items() %}
    <div class="signal-box" id="signal-box-{{ sig_name }}">
        <h3 class="signal-title">{{ sig_name }}</h3>
        <div class="signal-doc">{%if sig.documentation %}
{%markdown%}
{{ sig.documentation }}
{%endmarkdown%}
        {%endif%}
        </div>
        <div class="last-signal-value" ng-show="signals['{{sig_name|lowerCamelCase}}'].received"></div>
    </div>
    {%endfor%}{# end signals loop #}

    {%for prop_name, prop in stinger.properties.items() %}
    <div class="prop-box" id="prop-box-{{ prop_name }}">
        <h3 class="prop-title">{{ prop_name }}</h3>
        <div class="prop-doc">{%if prop.documentation %}
{%markdown%}
{{ prop.documentation }}
{%endmarkdown%}
        {%endif%}
        </div>
        <div class="last-signal-value" ng-show="properties['{{prop_name|lowerCamelCase}}'].received"></div>
    </div>
    {%endfor%} {# end properties loop #}

    {%for method_name, method in stinger.methods.items() %}
    <div class="method-box" id="method-box-{{ method_name }}">
        <h3 class="method-title">{{ method_name }}</h3>
        <div class="method-doc">{%if method.documentation %}
{%markdown%}
{{ method.documentation }}
{%endmarkdown%}
        {%endif%}
        </div>
        <div class="method-form-box">
            <form ng-submit="{{method_name}}MethodCall()">
                {%for arg in method.arg_list %}
                <div class="method-arg">
                    <label for="{{ method_name |snake_case}}-arg-{{ arg.name }}">{{ arg.name }} ({{ arg.type }})</label>
                    <input type="text" id="{{ method_name |snake_case}}-arg-{{ arg.name }}" ng-model="methods['{{ method_name|lowerCamelCase }}'].args['{{ arg.name }}']" />
                </div>
                {%endfor%}
                <button type="submit">Call {{ method_name }}</button>
            </form>
        </div>
        <div class="last-method-response" ng-bind="methods['{{ method_name }}'].received"></div>
    </div>
    {%endfor%} {# end methods loop #}

    {%raw%}
    <div id="console" ng-class="{ 'expanded' : (console.showing) }">
      <div class="top" ng-click=" console.showing = !console.showing ">Request Console <span ng-show="console.showing && console.requests.length > 0" ng-click="console.requests = []"> - Clear</span>
        <p class="expanded-toggle">{{ console.showing ? 'Hide' : 'Show' }}</p>
      </div>
      <div id="request-list">
        <p ng-repeat="msg in console.requests" class="entry">
          <strong>{{msg.name}}:</strong> <em>{{msg.topic}}</em> <span class="elapsedTime" ng-show="msg.responseTime">{{msg.responseTime - msg.requestTime}}ms</span><span class="elapsedTime" ng-show="msg.eventTime">{{msg.eventTime}}</span>
          <span class="outgoing" ng-show="msg.payload">{{msg.payload}}</span>
          <span class="incoming" ng-show="msg.response">{{msg.response}}</span>
          <span ng-repeat="result in msg.results" class="action-result">{{result}}</span>
        </p>
      </div>
    </div>
    {%endraw%}

    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.2/angular.min.js"></script>
    <script src="https://unpkg.com/mqtt@5.14.0/dist/mqtt.min.js"></script>
    <script src="app.js"></script>
  </body>
</html>